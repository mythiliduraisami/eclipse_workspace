<!DOCTYPE html>
<html>
<head>
	<title>Title</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/>

<!-- 	<script src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
				id="sap-ui-bootstrap"
				data-sap-ui-libs="sap.m"
				data-sap-ui-theme="sap_bluecrystal"
				 data-sap-ui-xx-bindingSyntax="complex">
		</script> -->
	<script id="sap-ui-bootstrap"
				src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
				data-sap-ui-theme="sap_bluecrystal"
				data-sap-ui-xx-bindingSyntax="complex"
				data-sap-ui-libs="sap.m, sap.ui.commons"></script>

	<!-- only load the mobile lib "sap.m" and the "sap_bluecrystal" theme -->
	<script>

		var oProdData1 = {
				ProductCollection: [
					{
						"ProductId": "1239102",
						"Name": "Power Projector 4713",
						"Category": "Projector",
						"SupplierName": "Titanium",
						"Description": "A very powerful projector",
						"WeightMeasure": 1467,
						"WeightUnit": "g",
						"Price": 856.49,
						"CurrencyCode": "EUR",
						"Status": "Available",
						"Quantity": 3,
						"UoM": "PC",
						"Width": 51,
						"Depth": 42,
						"Height": 18,
						"DimUnit": "cm"
					},
					{
						"ProductId": "22134T",
						"Name": "Webcam",
						"Category": "Accessory",
						"SupplierName": "Technocom",
						"Description": "Web camera, color, High-Speed USB",
						"WeightMeasure": 700,
						"WeightUnit": "g",
						"Price": 59,
						"CurrencyCode": "USD",
						"Status": "Available",
						"Quantity": 22,
						"UoM": "PC",
						"Width": 18,
						"Depth": 19,
						"Height": 21,
						"DimUnit": "cm"
						},
						{
						"ProductId": "P1239823",
						"Name": "Monitor Locking Cable",
						"Category": "Accessory",
						"SupplierName": "Technocom",
						"Description": "Lock for Monitor",
						"WeightMeasure": 40,
						"WeightUnit": "g",
						"Price": 13.49,
						"CurrencyCode": "JPY",
						"Status": "Available",
						"Quantity": 30,
						"UoM": "PC",
						"Width": 11,
						"Depth": 11,
						"Height": 3,
						"DimUnit": "cm"
					},
					{
						"ProductId": "214-121-828",
						"Name": "Laptop Case",
						"Category": "Accessory",
						"SupplierName": "Red Point Stores",
						"Description": "Laptop Case with room for pencils and other items",
						"WeightMeasure": 1289,
						"WeightUnit": "g",
						"Price": 78.99,
						"CurrencyCode": "INR",
						"Status": "Discontinued",
						"Quantity": 15,
						"UoM": "PC",
						"Width": 53,
						"Depth": 34,
						"Height": 7,
						"DimUnit": "cm"
					},
					{
						"ProductId": "XKP-312548",
						"Name": "USB Stick 16 GByte",
						"Category": "Accessory",
						"SupplierName": "Red Point Stores",
						"Description": "USB 2.0 HighSpeed 16GB",
						"WeightMeasure": 11,
						"WeightUnit": "g",
						"Price": 17.19,
						"CurrencyCode": "EUR",
						"Status": "Out of Stock",
						"Quantity": 45,
						"UoM": "PC",
						"Width": 6,
						"Depth": 2,
						"Height": 0.5,
						"DimUnit": "cm"
					},
					{
						"ProductId": "KTZ-12012.V2",
						"Name": "Deskjet Super Highspeed",
						"Category": "Printer",
						"SupplierName": "Red Point Stores",
						"Description": "1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet",
						"WeightMeasure": 100,
						"WeightUnit": "g",
						"Price": 117.19,
						"CurrencyCode": "EUR",
						"Status": "Available",
						"Quantity": 10,
						"UoM": "PC",
						"Width": 87,
						"Depth": 45,
						"Height": 39,
						"DimUnit": "cm"
					}
					]
		};

		var oProdModel1 = new sap.ui.model.json.JSONModel();
		oProdModel1.setData(oProdData1);
		sap.ui.getCore().setModel(oProdModel1);


		var oCol1 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Product"
			})
		});
		var oCol2 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Supplier"
			})
		});
		var oCol3 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Dimensions"
			})
		});
		var oCol4 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Weight"
			})
		});
		var oCol5 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Price"
			})
		});
		var oAddButton1 = new sap.m.Button({
			text:"Add Row",
			type:"Emphasized",
			icon:"sap-icon://add",
			press: function(){
        		var oNewObject = {
        				"ProductId": "KUZ-12012.V2",
        				"Name": "Deskjet Super A Speed",
        				"Category": "Printer",
        				"SupplierName": "Red Point Stores",
        				"Description": "1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet",
        				"WeightMeasure": 101,
        				"WeightUnit": "g",
        				"Price": 117.19,
        				"CurrencyCode": "SGD",
        				"Status": "Available",
        				"Quantity": 10,
        				"UoM": "PC",
        				"Width": 87,
        				"Depth": 45,
        				"Height": 39,
        				"DimUnit": "cm"
        				};
        		oProdModel1.oData.ProductCollection.push(oNewObject);
        		oProdData1.ProductCollection.sort();
        		oProdModel1.refresh();
        		oResponTable1.setModel(oProdModel1);

        		alert("Successfully added");
			}
		});
		var oDeleteButton1 = new sap.m.Button({
			text:"Delete Row",
			type:"Reject",
			icon:"sap-icon://sys-minus",
			press: function(oEvt){
				var nRows = oResponTable1.getItems().length;
				var oSelectedItems = oResponTable1.getSelectedItems();
				var nSelected = oSelectedItems.length;
				var sProducts = "";

				alert("selcted="+nSelected);


				if (nRows > 0 && nSelected > 0) {
					// Remove last items---
					//var oDelObject = oProdModel1.oData.ProductCollection.pop();
					//oProdModel1.refresh();
					//----
					/* Working code but cannot add item*/
					for ( var i = 0; i < oSelectedItems.length; i++) {
						var oSelectedRow = oSelectedItems[i];
						oResponTable1.removeItem(oSelectedRow);
					}
					oProdData1.ProductCollection.sort();
	        		oProdModel1.refresh();
	        		oResponTable1.setModel(oProdModel1);
	        		oResponTable1.removeSelections(true);

	        		/*
	        		Working but not working for index0
	        		var oTempModel = oResponTable1.getModel();
					var oTableData = oTempModel.getData();
				      var aContexts = oResponTable1.getSelectedContexts();
				      for (var i=aContexts.length -1; i>=0; i--) {
				        var oThisObj = aContexts[i].getObject();
				        var index = $.map(oTableData.ProductCollection, function(obj, index) {
				            if(obj === oThisObj) {
				                return index;
				            }
				        })
				        alert("index="+index)
				        oTableData.ProductCollection.splice(index, 1);
				      }

				      oTempModel.setData(oTableData);
				      oResponTable1.removeSelections(true);
				      */

	        		alert("Successfully deleted");
				}
				else if (nSelected <=0 && nRows >0) {
					alert("Please select row to Delete");
				}
				else if (nRows <= 0) {
					alert("No Rows to Delete");
				}

			}
		});
		var oTableTitle1 = new sap.m.Title({
			text:"Responsive Table - Products Table"
		});
		var oToolBarSpacer1 = new sap.m.ToolbarSpacer({width:""});

		var oResponTable1 = new sap.m.Table({
			//headerText:"Responsive Table - Products Table",
			headerToolbar:({

				active:true,
				content:[oTableTitle1,oToolBarSpacer1,oAddButton1,oDeleteButton1]
			}),
			inset:true,
			mode:"MultiSelect",
			 columns:[
				 oCol1,
				 oCol2,
				 oCol3,
				 oCol4,
				 oCol5
			 ]
		});


		oResponTable1.setModel(oProdModel1);
		//debugger;
		oResponTable1.bindAggregation(
			"items",{
			path:"/ProductCollection",
			sorter : new sap.ui.model.Sorter("Name"),
			template:  new sap.m.ColumnListItem({
	              cells:[
	            	  	new sap.m.ObjectIdentifier({
	            	  		title:"{Name}",
	            	  		text:"{ProductId}"
	            	  	}),
						new sap.m.Text({
							text:"{SupplierName}"
						}),
						new sap.m.Text({
							text:"{Width} x {Depth} x {Height} {DimUnit}"
						}),
						new sap.m.ObjectNumber({
							number:"{WeightMeasure}",
							unit:"{WeightUnit}",
							state:{
								path: "WeightMeasure",
								formatter: function(fWeightMeasure){
									try {
										fWeightMeasure = parseFloat(fWeightMeasure);
										if (fWeightMeasure < 0) {
											return "None";
										} else if (fWeightMeasure < 1000) {
											return "Success";
										} else if (fWeightMeasure < 2000) {
											return "Warning";
										} else {
											return "Error"
										}
									} catch (err) {
										return "None";
										}
								}

							}
						}),
						new sap.ui.unified.Currency({
							currency:"{CurrencyCode}",
							//maxPrecision:3,
							useSymbol:true,
							value:"{Price}"
						})

	            	  ]
				})
			});


		//console.log("formatter status")
		//console.log("oList2="+oList2.getModel().getData().names);

		var oPage2 = new sap.m.Page({
			title: "Responsive Table Example",
			content: [
				oResponTable1
			]
		});

 		var oResApp = new sap.m.App({
 			pages:[oPage2]
 		}).placeAt("content");


 		//console.log("oList2 B4 script end ="+oList2.getModel().getData().names);
	</script>

</head>
<body class="sapUiBody" role="application">
		<div id="content"></div>
	</body>
</html>
