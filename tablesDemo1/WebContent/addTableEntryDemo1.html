<!DOCTYPE html>
<html>
<head>
	<title>Title</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/>
	<script id="sap-ui-bootstrap"
				src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
				data-sap-ui-theme="sap_bluecrystal"
				data-sap-ui-xx-bindingSyntax="complex"
				data-sap-ui-libs="sap.m, sap.ui.commons"></script>

	<!-- only load the mobile lib "sap.m" and the "sap_bluecrystal" theme -->
	<script>
	jQuery.sap.require("sap.m.MessageBox");

		var oProdData1 = {
				ProductCollection: [
					{
						"ProductId": "1239102",
						"Name": "Power Projector 4713",
						"Category": "Projector",
						"SupplierName": "Titanium",
						"Description": "A very powerful projector",
						"WeightMeasure": 1467,
						"WeightUnit": "g",
						"Price": 856.49,
						"CurrencyCode": "EUR",
						"Status": "Available",
						"Quantity": 3,
						"UoM": "PC",
						"Width": 51,
						"Depth": 42,
						"Height": 18,
						"DimUnit": "cm"
					},
					{
						"ProductId": "22134T",
						"Name": "Webcam",
						"Category": "Accessory",
						"SupplierName": "Technocom",
						"Description": "Web camera, color, High-Speed USB",
						"WeightMeasure": 700,
						"WeightUnit": "g",
						"Price": 59,
						"CurrencyCode": "USD",
						"Status": "Available",
						"Quantity": 22,
						"UoM": "PC",
						"Width": 18,
						"Depth": 19,
						"Height": 21,
						"DimUnit": "cm"
						},
						{
						"ProductId": "P1239823",
						"Name": "Monitor Locking Cable",
						"Category": "Accessory",
						"SupplierName": "Technocom",
						"Description": "Lock for Monitor",
						"WeightMeasure": 40,
						"WeightUnit": "g",
						"Price": 13.49,
						"CurrencyCode": "JPY",
						"Status": "Available",
						"Quantity": 30,
						"UoM": "PC",
						"Width": 11,
						"Depth": 11,
						"Height": 3,
						"DimUnit": "cm"
					},
					{
						"ProductId": "214-121-828",
						"Name": "Laptop Case",
						"Category": "Accessory",
						"SupplierName": "Red Point Stores",
						"Description": "Laptop Case with room for pencils and other items",
						"WeightMeasure": 1289,
						"WeightUnit": "g",
						"Price": 78.99,
						"CurrencyCode": "INR",
						"Status": "Discontinued",
						"Quantity": 15,
						"UoM": "PC",
						"Width": 53,
						"Depth": 34,
						"Height": 7,
						"DimUnit": "cm"
					},
					{
						"ProductId": "XKP-312548",
						"Name": "USB Stick 16 GByte",
						"Category": "Accessory",
						"SupplierName": "Red Point Stores",
						"Description": "USB 2.0 HighSpeed 16GB",
						"WeightMeasure": 11,
						"WeightUnit": "g",
						"Price": 17.19,
						"CurrencyCode": "EUR",
						"Status": "Out of Stock",
						"Quantity": 45,
						"UoM": "PC",
						"Width": 6,
						"Depth": 2,
						"Height": 0.5,
						"DimUnit": "cm"
					},
					{
						"ProductId": "KTZ-12012.V2",
						"Name": "Deskjet Super Highspeed",
						"Category": "Printer",
						"SupplierName": "Red Point Stores",
						"Description": "1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet",
						"WeightMeasure": 100,
						"WeightUnit": "g",
						"Price": 117.19,
						"CurrencyCode": "EUR",
						"Status": "Available",
						"Quantity": 10,
						"UoM": "PC",
						"Width": 87,
						"Depth": 45,
						"Height": 39,
						"DimUnit": "cm"
					}
					]
		};

		var oProdModel1 = new sap.ui.model.json.JSONModel();
		oProdModel1.setData(oProdData1);
		sap.ui.getCore().setModel(oProdModel1);


		var oCol1 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Product"
			})
		});
		var oCol2 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Supplier"
			})
		});
		var oCol3 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Dimensions"
			})
		});
		var oCol4 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Weight"
			})
		});
		var oCol5 = new sap.m.Column({
			header:new sap.m.Label({
				text:"Price"
			})
		});
		var oAddButton1 = new sap.m.Button({
			text:"Add Row",
			type:"Emphasized",
			icon:"sap-icon://add",
			press: function(){
				var oButton1 =new sap.m.Button({
					text: "Save New Entry",

                    press: function(){
            			
                    	var content = sap.ui.getCore().getElementById("simpleForm1").getContent();
                    	var fPrice1 = 0.0;
                    	try {
							fPrice1 = parseFloat(content[15].getValue());
						} catch (e) {
							// TODO: handle exception
							console.log(e);
						}
                    	
                		
                    	var oNewObject2 = {
                				
                				/*"ProductId": sap.ui.getCore().getElementById("ProductId_ID").getValue(),
                				"Name": sap.ui.getCore().getElementById("Name_ID").getValue(),
                				"Category": sap.ui.getCore().getElementById("Category_ID").getValue(),
                				"SupplierName": sap.ui.getCore().getElementById("SupplierName_ID").getValue(),
                				"Description": sap.ui.getCore().getElementById("Description_ID").getValue(),
                				"WeightMeasure": sap.ui.getCore().getElementById("WeightMeasure_ID").getValue(),
                				"WeightUnit": sap.ui.getCore().getElementById("WeightUnit_ID").getValue(),
                				"Price": sap.ui.getCore().getElementById("Price_ID").getValue(),
                				"CurrencyCode": sap.ui.getCore().getElementById("CurrencyCode_ID").getValue(),
                				"Status": sap.ui.getCore().getElementById("Status_ID").getValue(),
                				"Quantity": sap.ui.getCore().getElementById("Quantity_ID").getValue(),
                				"UoM": sap.ui.getCore().getElementById("UoM_ID").getValue(),
                				"Width": sap.ui.getCore().getElementById("Width_ID").getValue(),
                				"Depth": sap.ui.getCore().getElementById("Depth_ID").getValue(),
                				"Height": sap.ui.getCore().getElementById("Height_ID").getValue(),
                				"DimUnit": sap.ui.getCore().getElementById("DimUnit_ID").getValue(),*/
                				"ProductId": content[1].getValue(),
                				"Name": content[3].getValue(),
                				"Category": content[5].getValue(),
                				"SupplierName": content[7].getValue(),
                				"Description": content[9].getValue(),
                				"WeightMeasure": content[11].getValue(),
                				"WeightUnit": content[13].getValue(),
               					"Price": fPrice1,
                				"CurrencyCode": content[17].getValue(),
                				"Status": content[19].getValue(),
                				"Quantity": content[21].getValue(),
                				"UoM": content[23].getValue(),
                				"Width": content[25].getValue(),
                				"Depth": content[27].getValue(),
                				"Height": content[29].getValue(),
                				"DimUnit": content[31].getValue()      
                			
                		}
                		
                		oProdModel1.oData.ProductCollection.push(oNewObject2);
                		oProdData1.ProductCollection.sort();
                		oProdModel1.refresh();
                		oResponTable1.setModel(oProdModel1);
                		oDialog1.close();
                    	alert("New Entry Added to JSONModel");

                    }
				});
				var oButton2 =new sap.m.Button({
					text: "Cancel",

                    press: function(){
                    	new sap.m.MessageBox.confirm("Do you want to close this window?", {
                    	    title: "Confirm",                                    // default
                    	    onClose: function(oAction) {
                  	          if (oAction === sap.m.MessageBox.Action.YES) {
                	        	  oDialog1.close();
                	          }
                	        },                                       // default
                    	    styleClass: "",                                      // default
                    	    actions: [ sap.m.MessageBox.Action.YES, sap.m.MessageBox.Action.NO ] ,         // default
                    	    emphasizedAction: sap.m.MessageBox.Action.OK,        // default
                    	    initialFocus: null,                                  // default
                    	    textDirection: sap.ui.core.TextDirection.Inherit
                    	});
                     }
				});
				var oDialog1 = new sap.m.Dialog("Dialog1",{
				     title:"Create Product Entries",				     
				     buttons: [oButton1, oButton2],
				     closeOnNavigation:true,
				     content:[
				    	 	new sap.ui.layout.form.SimpleForm("simpleForm1",{
				    			title: "Add New Product",
								maxContainerCols: 2,
								content:[
									new sap.m.Label({text:"ProductId"}),
									new sap.m.Input({ maxLength: 15, placeholder:"KUTZ-12012.V2"}),
									new sap.m.Label({text:"Name"}),
									new sap.m.Input({maxLength: 25, placeholder:"Deskjet Super peed"}),
									new sap.m.Label({text:"Category"}),
									new sap.m.Input({maxLength: 20,placeholder:"Printer"}),
									new sap.m.Label({text:"SupplierName"}),
									new sap.m.Input({maxLength: 25,placeholder:"Red Point Stores"}),
									new sap.m.Label({text:"Description"}),
									new sap.m.TextArea({cols:80, rows:3, maxLength: 250,placeholder:"1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet"}),
									new sap.m.Label({text:"WeightMeasure"}),
									new sap.m.Input({maxLength: 20,placeholder:"101"}),
									new sap.m.Label({text:"WeightUnit"}),
									new sap.m.Input({maxLength: 20,placeholder:"g"}),
									new sap.m.Label({text:"Price"}),
									new sap.m.Input({maxLength: 20,placeholder:"117.19"}),
									new sap.m.Label({text:"CurrencyCode"}),
									new sap.m.Input({maxLength: 20,placeholder:"EUR"}),
									new sap.m.Label({text:"Status"}),
									new sap.m.Input({maxLength: 20,placeholder:"Available"}),
									new sap.m.Label({text:"Quantity"}),
									new sap.m.Input({type: "Number",maxLength: 20,placeholder:"10"}),
									new sap.m.Label({text:"UoM"}),
									new sap.m.Input({maxLength: 20,placeholder:"PC"}),
									new sap.m.Label({text:"Width"}),
									new sap.m.Input({type: "Number", maxLength: 20,placeholder:"87"}),
									new sap.m.Label({text:"Depth"}),
									new sap.m.Input({type: "Number",maxLength: 20,placeholder:"45"}),
									new sap.m.Label({text:"Height"}),
									new sap.m.Input({type: "Number",maxLength: 20,placeholder:"39"}),
									new sap.m.Label({text:"DimUnit"}),
									new sap.m.Input({maxLength: 20,placeholder:"cm"})
						          /*new sap.m.Label({text:"ProductId"}),
						          new sap.m.Input({maxLength: 15,id: "ProductId_ID",placeholder:"KUTZ-12012.V2"}),
						          new sap.m.Label({text:"Name"}),
						          new sap.m.Input({maxLength: 25, id: "Name_ID",placeholder:"Deskjet Super peed"}),
						          new sap.m.Label({text:"Category"}),
						          new sap.m.Input({maxLength: 20,id: "Category_ID",placeholder:"Printer"}),
						          new sap.m.Label({text:"SupplierName"}),
						          new sap.m.Input({maxLength: 25,id: "SupplierName_ID",placeholder:"Red Point Stores"}),
						          new sap.m.Label({text:"Description"}),
						          new sap.m.TextArea({cols:120, rows:3, maxLength: 250,id: "Description_ID",placeholder:"1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet"}),
						          new sap.m.Label({text:"WeightMeasure"}),
						          new sap.m.Input({maxLength: 20,id: "WeightMeasure_ID",placeholder:"101"}),
						          new sap.m.Label({text:"WeightUnit"}),
						          new sap.m.Input({maxLength: 20,id: "WeightUnit_ID",placeholder:"g"}),
						          new sap.m.Label({text:"Price"}),
						          new sap.m.Input({maxLength: 20,id: "Price_ID",placeholder:"117.19"}),
						          new sap.m.Label({text:"CurrencyCode"}),
						          new sap.m.Input({maxLength: 20,id: "CurrencyCode_ID",placeholder:"EUR"}),
						          new sap.m.Label({text:"Status"}),
						          new sap.m.Input({maxLength: 20,id: "Status_ID",placeholder:"Available"}),
						          new sap.m.Label({text:"Quantity"}),
						          new sap.m.Input({type: "Number",maxLength: 20,id: "Quantity_ID",placeholder:"10"}),
						          new sap.m.Label({text:"UoM"}),
						          new sap.m.Input({maxLength: 20,id: "UoM_ID",placeholder:"PC"}),
						          new sap.m.Label({text:"Width"}),
						          new sap.m.Input({type: "Number", maxLength: 20,id: "Width_ID",placeholder:"87"}),
						          new sap.m.Label({text:"Depth"}),
						          new sap.m.Input({type: "Number",maxLength: 20,id: "Depth_ID",placeholder:"45"}),
						          new sap.m.Label({text:"Height"}),
						          new sap.m.Input({type: "Number",maxLength: 20,id: "Height_ID",placeholder:"39"}),
						          new sap.m.Label({text:"DimUnit"}),
						          new sap.m.Input({maxLength: 20,id: "DimUnit_ID",placeholder:"cm"})*/
						          ]
							})
				     ],
				     afterClose:function(oEvent){
				    	 oEvent.getSource().destroy();
				     }
				});
				oDialog1.addStyleClass("sapUiContentPadding");
				sap.ui.getCore().byId("Dialog1").open();
			
        		/*var oNewObject = {
        				"ProductId": "KUZ-12012.V2",
        				"Name": "Deskjet Super A Speed",
        				"Category": "Printer",
        				"SupplierName": "Red Point Stores",
        				"Description": "1200 dpi x 1200 dpi – up to 25 ppm (mono) / up to 24 ppm (colour) – capacity: 100 sheets – Hi-Speed USB2.0, Ethernet",
        				"WeightMeasure": 101,
        				"WeightUnit": "g",
        				"Price": 117.19,
        				"CurrencyCode": "SGD",
        				"Status": "Available",
        				"Quantity": 10,
        				"UoM": "PC",
        				"Width": 87,
        				"Depth": 45,
        				"Height": 39,
        				"DimUnit": "cm"
        				};
        		oProdModel1.oData.ProductCollection.push(oNewObject);
        		oProdData1.ProductCollection.sort();
        		oProdModel1.refresh();
        		oResponTable1.setModel(oProdModel1);

        		alert("Successfully added");*/
			}
		});
		var oDeleteButton1 = new sap.m.Button({
			text:"Delete Row",
			type:"Reject",
			icon:"sap-icon://sys-minus",
			press: function(oEvt){
				var nRows = oResponTable1.getItems().length;
				var oSelectedItems = oResponTable1.getSelectedItems();
				var nSelected = oSelectedItems.length;
				var sProducts = "";

				//alert("selcted="+nSelected);

				if (nRows > 0 && nSelected > 0) {
					// Remove last items---
					//var oDelObject = oProdModel1.oData.ProductCollection.pop();
					//oProdModel1.refresh();
					//----
					/* Working code but cannot add item*/
					for ( var i = 0; i < oSelectedItems.length; i++) {
						var oSelectedRow = oSelectedItems[i];
						oResponTable1.removeItem(oSelectedRow);
					}
					oProdData1.ProductCollection.sort();
	        		oProdModel1.refresh();
	        		oResponTable1.setModel(oProdModel1);
	        		oResponTable1.removeSelections(true);

	        		/*
	        		Working but not working for index0
	        		var oTempModel = oResponTable1.getModel();
					var oTableData = oTempModel.getData();
				      var aContexts = oResponTable1.getSelectedContexts();
				      for (var i=aContexts.length -1; i>=0; i--) {
				        var oThisObj = aContexts[i].getObject();
				        var index = $.map(oTableData.ProductCollection, function(obj, index) {
				            if(obj === oThisObj) {
				                return index;
				            }
				        })
				        alert("index="+index)
				        oTableData.ProductCollection.splice(index, 1);
				      }

				      oTempModel.setData(oTableData);
				      oResponTable1.removeSelections(true);
				      */

	        		alert("Successfully deleted");
				}
				else if (nSelected <=0 && nRows >0) {
					alert("Please select row to Delete");
				}
				else if (nRows <= 0) {
					alert("No Rows to Delete");
				}

			}
		});
		var oTableTitle1 = new sap.m.Title({
			text:"Responsive Table - Products Table"
		});
		var oToolBarSpacer1 = new sap.m.ToolbarSpacer({width:""});

		var oResponTable1 = new sap.m.Table({
			//headerText:"Responsive Table - Products Table",
			headerToolbar:({

				active:true,
				content:[oTableTitle1,oToolBarSpacer1,oAddButton1,oDeleteButton1]
			}),
			inset:true,
			mode:"MultiSelect",
			 columns:[
				 oCol1,
				 oCol2,
				 oCol3,
				 oCol4,
				 oCol5
			 ]
		});


		oResponTable1.setModel(oProdModel1);
		//debugger;
		oResponTable1.bindAggregation(
			"items",{
			path:"/ProductCollection",
			sorter : new sap.ui.model.Sorter("Name"),
			template:  new sap.m.ColumnListItem({
	              cells:[
	            	  	new sap.m.ObjectIdentifier({
	            	  		title:"{Name}",
	            	  		text:"{ProductId}"
	            	  	}),
						new sap.m.Text({
							text:"{SupplierName}"
						}),
						new sap.m.Text({
							text:"{Width} x {Depth} x {Height} {DimUnit}"
						}),
						new sap.m.ObjectNumber({
							number:"{WeightMeasure}",
							unit:"{WeightUnit}",
							state:{
								path: "WeightMeasure",
								formatter: function(fWeightMeasure){
									try {
										fWeightMeasure = parseFloat(fWeightMeasure);
										if (fWeightMeasure < 0) {
											return "None";
										} else if (fWeightMeasure < 1000) {
											return "Success";
										} else if (fWeightMeasure < 2000) {
											return "Warning";
										} else {
											return "Error"
										}
									} catch (err) {
										return "None";
										}
								}

							}
						}),
						new sap.ui.unified.Currency({
							currency:"{CurrencyCode}",
							//maxPrecision:3,
							useSymbol:true,
							value:"{Price}"
						})

	            	  ]
				})
			});


		//console.log("formatter status")
		//console.log("oList2="+oList2.getModel().getData().names);

		var oPage2 = new sap.m.Page({
			title: "Responsive Table Example",
			content: [
				oResponTable1
			]
		});

 		var oResApp = new sap.m.App({
 			pages:[oPage2]
 		}).placeAt("content");


 		//console.log("oList2 B4 script end ="+oList2.getModel().getData().names);
	</script>

</head>
<body class="sapUiBody" role="application">
		<div id="content"></div>
	</body>
</html>
